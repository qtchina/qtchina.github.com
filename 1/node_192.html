<!DOCTYPE HTML>
<html>
    <head>
        <meta charset='utf8'>
        <title>clisp 语言中的结构体</title>
        <link rel="stylesheet" href="../css/base.css" type="text/css" />
    </head>
<body>

<table width="80%" height="80 px" align="center">
  <tr>
    <td>
      <div id="branding"><strong><a href="/">
        <img src="../images/nullget_labs.gif" alt="www.qtchina.net " title="www.qtchina.net " id="logo" />
        <span>www.qtchina.net</span>            </a></strong></div>
      </div>
    </td>
  </tr>
</table>

<table width="80%" align="center">
  <tr>
    <td>
      <h2>clisp 语言中的结构体</h2>
    </td>
  </tr>

  <tr>
    <td>
      发布： 2008-07-23 07:56
    </td>
  </tr>

  <tr>
    <td width="50%">
      <br />
1. defstruct语法结构：<br />
<br />
(defstruct struct-name (filed1 default-value :type filed-type) <br />
  (filed2 default-value2 :type filed-type2) ... )<br />
<br />
struct-name 为定义的结构体的名字，可以是clisp允许的符号名。<br />
field1     结构第一个成员变量名，可以是clisp允许的任何符号名。<br />
default-value  该成员的默认值<br />
:type   后面的值指定该成员的数据类型<br />
field-type    该成员的数据类型，可以是string, integer 等clisp实现的数据类型。<br />
<br />
field2, default-value2, field-type2与上同。<br />
<br />
2. 构造clisp结构体<br />
<br />
定义了结构体后，可以使用MAKE- + struct-name函数构造结构体<br />
如定义一个结构体 person,<br />
<br />
CLISP> (defstruct person (name "john" :type string)<br />
  (age 23 :type integer))<br />
<br />
然后使用函数 make-person 构造结构体变量，这函数不需要另外定义。<br />
<br />
CLISP> (make-person :name "james" :age 30)<br />
#S(PERSON :NAME "james" :AGE 30)<br />
<br />
如果调用make-person函数不带参数，则构造一个默认的person变量：<br />
CLISP> (make-person)<br />
#S(PERSON :NAME "john" :AGE 23)<br />
<br />
这变量中的成员值为定义结构体时指定的默认值。<br />
<br />
3. 构造一个结构体并赋值给一个变量。<br />
<br />
CLISP> (setq person_1 (make-person :name "qtchina" :age 28))<br />
CLISP> (print person_1)<br />
#S(PERSON :NAME "qtchina" :AGE 28)<br />
<br />
4. 引用结构体中的成员的值。<br />
<br />
定义结构体的时候clisp会为我们定义一个函数 structure-name-slot-name，可以使用这个函数<br />
引用结构体成员中的值,该函数只有一个参数，结构体变量名。.<br />
<br />
CLISP> (print (person-name person_1))<br />
<br />
"qtchina"<br />
"qtchina"<br />
<br />
5. 修改结构体中的成员的值。<br />
<br />
可以使用第4节中的方法修改成员的值。<br />
<br />
CLISP> setf (person-name person_1) "qter")<br />
"qter"<br />
<br />
CLISP> (print person_1)<br />
#S(PERSON :NAME "qter" :AGE 28) <br />
#S(PERSON :NAME "qter" :AGE 28)<br />
<br />
可以看到结构体变量中的成员变量的值已经修改了。<br />
<br />
6. 结构体拷贝<br />
<br />
在声明结构体的同时，clisp为我们定义了拷贝函数： copy-structure-name<br />
<br />
CLISP> (setq person_copy (copy-person person_1))<br />
#S(PERSON :NAME "qter" :AGE 28)<br />
<br />
但注意拷贝过来的值与原来的直是不同的，虽然它们的值相同，即<br />
CLISP> (eq person_copy person_1)<br />
NIL<br />
所以上面的copy-person为拷贝赋值。<br />
<br />
而如果执行<br />
CLISP> (setq person_same person_1)<br />
#S(PERSON :NAME "qter" :AGE 28)<br />
CLISP> (eq person_same person_1)<br />
T<br />
<br />
这个才是引用赋值，用eq函数比较才返回真值。<br />
<br />
<br />
defstruct 还中更高级的语法，可参数其他文档。<br />

    </td>
  </tr>
  <tr>
    <td>
      <br /><br />
      原文： <a href='http://nullget.sourceforge.net/?q=node/192'>http://nullget.sourceforge.net/?q=node/192</a>
    </td>
  </tr>

</table>

<p></p>
<p></p>
<p></p>
<table width="60%"><tr><td  align="center">
  <div>
    <span>Powered by <a href="http://nullget.sourceforge.net">zexport</a></span>  </div>
  </div>
  </td></tr></table>

<br />
<div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-51467019-1', 'qtchina.github.io');
  ga('send', 'pageview');

</script>

</div>
</body>
</html>
