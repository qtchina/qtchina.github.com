
<!DOCTYPE HTML>
<html>
<head>
<meta charset='utf8'>
<title>OUTLOOK菜单类</title>
</head>
<body>
&lt;HTML&gt;<br />&lt;HEAD&gt;<br />&lt;TITLE&gt;outlook菜单&lt;/TITLE&gt;<br />&lt;META http-equiv=content-type content=text/html;charset=gb2312&gt;<br />&lt;style&gt;<br />.outlook-title<br />{<br />    border:1px outset;    [color=#F0F8FF][/color]<br />    background-color:buttonface;<br />    color:black;<br />    text-align:center;<br />    cursor:hand;<br />    font-size:9pt;<br />}<br />.outlook-item<br />{<br />    padding:2px;<br />    font-size:9pt;<br />}<br /><br />a.outlook-item:hover<br />{<br />    color:blue;<br />}<br />&lt;/style&gt;<br />&lt;/HEAD&gt;<br />&lt;BODY style="MARGIN: 0px" text=black vLink=white aLink=white link=white scroll=no&gt;<br />&lt;table height="100%" width="100%" border=0 cellpadding=0 cellspacing=0&gt;<br />    &lt;tr&gt;&lt;td width="140"&gt;<br />        &lt;TABLE style="WIDTH: 140px; HEIGHT: 100%" cellSpacing=0 cellPadding=0 bgColor=#aca899 border=1 hspace="0" vspace="0"&gt;<br />        &lt;TR&gt;<br />        &lt;TD id=outLookBarShow style="HEIGHT: 100%"  align=middle name="outLookBarShow"&gt;<br />            &lt;div id="o1" style="height:100%;"&gt;&lt;/div&gt;<br />        &lt;/td&gt;<br />        &lt;/tr&gt;<br />        &lt;/table&gt;<br />    &lt;/td&gt;&lt;td&gt;&lt;iframe id="frm" name="frm" width="100%" height="100%" frameborder=0&gt;&lt;/iframe&gt;&lt;/td&gt;&lt;/tr&gt;<br />&lt;/table&gt;<br /><br />&lt;SCRIPT LANGUAGE="JavaScript"&gt;<br />&lt;!--<br />/* <br /> **    ================================================================================================== <br /> **    类名：CLASS_OUTLOOKBAR <br /> **    功能：OUTLOOK菜单 <br /> **    示例： <br />     --------------------------------------------------------------------------------------------------- <br />       var o = new CLASS_OUTLOOKBAR();<br />        o.addTitle("工作安排");<br />        o.addTitle("通告信息");<br />        o.addTitle("管理制度");<br />        o.addTitle("系统管理");<br /><br />        o.addItem(0,"今日安排","frm","http://www.google.com");<br />        o.addItem(0,"工作任务","frm","http://baidu.com");<br /><br />        o.addItem(1,"报社通知","frm","http://www.itpub.net/forum6.html",null);<br /><br />        o.setupById("o1");<br /><br />        //定义需要安装的DIV<br />        &lt;div id="o1" style="height:100%;"&gt;&lt;/div&gt;<br /><br />      --------------------------------------------------------------------------------------------------- <br /> **    作者：ttyp <br /> **    邮件：ttyp@21cn.com <br /> **    日期：2005-12-25 <br /> **    ================================================================================================== <br /> */<br />function CLASS_OUTLOOKBAR(id,name)<br />{<br />    var THIS1 = this;<br /><br />    this.id    = getUnique(id);<br />    this.name = getUnique(name);<br />    this.width = "140";<br />    this.height = "100%";<br />    this.titles = new Array();<br /><br />    function getUnique(p){<br />        if(p!=null){<br />            return p;<br />        } else {<br />            return "outlook_" + new Date().getTime() + "_";<br />        }<br />    }<br /><br />    this.addTitle = function(name){ <br />   <br />        function title(name){<br />            var THIS2    = this;<br />            this.name    = name;<br />            this.items    = new Array();<br />                    this.addItem = function(name,target,url,image,align){<br /><br />                function item(name,target,url,image,align){<br />                    this.name = name;<br />                    this.image = image;<br />                    this.target = target;<br />                    this.url = url;<br />                    this.align = align;<br />                }<br /><br />                var        _item = new item(name,target,url,image,align);<br />                THIS2.items[THIS2.items.length] = _item;<br />                return _item;<br />            }<br />        }<br /><br />        var _title = new title(name);<br /><br />        this.titles[this.titles.length] = _title;<br /><br />        return _title;<br />    }<br /><br />    this.step    = 4;<br />    this.speed    = 10;<br />    this.selectedIndex = 0;<br />    this.timer  = 0;<br />    this.rate    = 100;<br /><br />    this.select = function(index){<br />        if(this.selectedIndex!=index){<br />            this.rate = 100;<br />            this.timer = window.setInterval(function(){<br /><br />                THIS1.rate-= THIS1.step;<br /><br />                var oldI = document.getElementById(THIS1.id + THIS1.selectedIndex).nextSibling;<br />                var newI = document.getElementById(THIS1.id + index).nextSibling;<br /><br />                oldI.style.display = "";<br />                newI.style.display = "";<br /><br />                if(THIS1.rate&lt;0)<br />                {<br />                    window.clearInterval(THIS1.timer);<br />                    oldI.style.display = "none";<br />                    THIS1.selectedIndex = index;<br />                } else {<br />                                oldI.style.height = THIS1.rate +"%";<br />                    newI.style.height = (100 - THIS1.rate) + "%";<br /><br />                }<br /><br />            },this.speed); <br />                   }<br />    }<br /><br />    this.setup = function(contain){<br />        if(contain!=null){ <br />                   var table = document.createElement("table");<br />                table.style.width    = "100%";<br />                table.style.height    = "100%";<br />                table.cellPadding = "0px";<br />                table.cellSpacing = "0px";<br />                table.style.border = "0px solid red";<br />                table.bgColor = "#aca899";<br /><br />                function getItem(width,height,display,title){<br />                    var tris = document.createElement("tr");<br />                    var tdis = document.createElement("td");<br />                        tdis.style.width = width;<br />                        tris.style.height = height;<br />                        tris.style.display = display;<br />                        tdis.className    = "outlook-item";<br />                        tdis.style.verticalAlign = "top"; <br />   <br />                        if(title!=null&&typeof(title.items)!="undefined"){<br />                                                        var vv = document.createElement("div");<br />                                vv.style.overflow = "auto";<br />                                vv.style.height = "100%";<br />                                vv.style.width = "100%";<br /><br />                            for(var i=0;i&lt;title.items.length;i++){<br />                                var div = document.createElement("div");<br />                                    div.style.textAlign = "center";<br />                                    div.style.height = "24px"; <br />                                                                       div.style.paddingTop = "4px";<br /><br />                                if(title.items[i].image!=null){<br />                                    var img = document.createElement("img");<br />                                        img.src = title.items[i].image;<br />                                        div.appendChild(img);<br />                                    if(typeof(title.items[i].align)!="undefined"&&title.items[i].align==1){<br />                                        var lbl = document.createElement("label");<br />                                            lbl.innerHTML = "&lt;br&gt;";<br />                                            div.appendChild(lbl);<br />                                    }<br />                                }<br /><br />                                var a    = document.createElement("a");<br />                                    a.target    = title.items[i].target;<br />                                    a.innerHTML = title.items[i].name;<br />                                    a.href        = title.items[i].url;<br />                                    div.appendChild(a);<br />                                    vv.appendChild(div); <br />                                                                                                           } <br />                   <br />                            tdis.appendChild(vv);<br />                        }<br /><br />                        tris.appendChild(tdis);<br />                        return tris;<br />                }<br />                        for(var i=0;i&lt;this.titles.length;i++){ <br />                           var tr = document.createElement("tr");<br />                    var td = document.createElement("td");<br /><br />                        tr.style.height = "25px";<br />                        td.style.width    = "100%"; <br />                                               td.className    = "outlook-title"; <br />   <br />                        td.innerHTML    = this.titles[i].name;<br />                        tr.id            = this.id + i;<br />                                                                                                tr.appendChild(td);<br />                        table.appendChild(tr);<br />                                                if (i==this.selectedIndex){<br />                            var tris = getItem("100%","100%","",this.titles[i]);<br />                                table.appendChild(tris); <br />                                                       } else {<br />                            var tri    = getItem("100%","0%","none",this.titles[i]);<br />                                table.appendChild(tri);<br />                        } <br />                                                               }<br /><br />                if(typeof(contain.outerHTML)=="undefined"){<br />                    contain.appendChild(table);<br />                } else { <br />                           contain.innerHTML = table.outerHTML;<br />                } <br />                                   //bind event<br />                for(var i=0;i&lt;this.titles.length;i++){<br />                    var title = document.getElementById(this.id + i);<br />                    if(title){<br />                        function mapping(index){<br />                            try    {<br />                                title.onclick = function(){THIS1.select(index);}<br />                                title.oncontextmenu = function(){ return false;}<br />                                title.nextSibling.oncontextmenu = function(){return false;}<br />                            } catch (e){<br />                            }<br />                        }<br />                        mapping(i);<br />                    }<br />                }<br />        }<br />    }<br /><br />    this.addItem = function(index,name,target,url,image,align){<br />        if(index&gt;=0&&index&lt;this.titles.length){<br />            return this.titles[index].addItem(name,target,url,image,align);<br />        }<br />    }<br /><br />    this.setupById = function(id){<br />        var d = document.getElementById(id);<br />        if(d){<br />            this.setup(d);<br />        }<br />    }<br />}<br /><br />var o = new CLASS_OUTLOOKBAR();<br />    o.addTitle("工作安排");<br />    o.addTitle("通告信息");<br />    o.addTitle("管理制度");<br />    o.addTitle("系统管理");<br /><br />    o.addItem(0,"今日安排","frm","http://www.google.com");<br />    o.addItem(0,"工作任务","frm","http://baidu.com");<br /><br />    o.addItem(1,"报社通知","frm","http://www.itpub.net/forum6.html",null);<br /><br />    o.setupById("o1");<br /><br />//--&gt;<br />&lt;/SCRIPT&gt;<br /><br />&lt;/BODY&gt;<br />&lt;/HTML&gt;<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
</body>
</html>
