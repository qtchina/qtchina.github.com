
<!DOCTYPE HTML>
<html>
<head>
<meta charset='utf8'>
<title>一个字符串切割PL/SQL函数</title>
</head>
<body>
<br />最近写PL/SQL，遇到需要分割字符串的问题，没有找到已有代码，自己动手写了一个，应该。其中使用了PL/SQL几个函数，如果不理解其意义，可以查一下函数手册，有的函数的意义其实和我们的想象不同。<br /><br />  FUNCTION SPLIT_STR(SRC_STR IN VARCHAR2, SEP_CHAR IN VARCHAR2) RETURN NUMBER IS<br />    TYPE STRING_ARRAY IS TABLE OF VARCHAR2(60) INDEX BY BINARY_INTEGER;<br />    LSEP_COUNT NUMBER;<br />    SPLIT_ARR  STRING_ARRAY;<br />    STR_LEN    NUMBER;<br />    STR_TMP    VARCHAR2(60);<br />  BEGIN<br />      LSEP_COUNT := 0;<br />      STR_LEN := LENGTH(SRC_STR);<br />      /*<br />    SPLIT_ARR(1) := '';<br />    SPLIT_ARR(2) := '';<br />    SPLIT_ARR(3) := '';<br />    SPLIT_ARR(4) := '';<br />    SPLIT_ARR(5) := '';<br />    SPLIT_ARR(6) := '';<br />    SPLIT_ARR(7) := '';<br />    SPLIT_ARR(8) := '';<br />    */<br />      FOR IC IN 1 .. STR_LEN LOOP<br />      STR_TMP := SUBSTR(SRC_STR, IC);<br />          IF ASCII(STR_TMP) = ASCII(SEP_CHAR) THEN<br />        IF LENGTH(SPLIT_ARR(LSEP_COUNT + 1)) = 0 THEN<br />          NULL;<br />        ELSE<br />          LSEP_COUNT := LSEP_COUNT + 1;<br />        END IF;<br />      ELSE<br />        BEGIN<br />          IF LENGTH(SPLIT_ARR(LSEP_COUNT + 1)) = 0 THEN<br />            SPLIT_ARR(LSEP_COUNT + 1) := '';<br />          END IF;<br />        EXCEPTION  -- PL/SQL中数组初始化第一次使用到的元素<br />          WHEN NO_DATA_FOUND THEN<br />            SPLIT_ARR(LSEP_COUNT + 1) := ''; <br />        END;<br />        SPLIT_ARR(LSEP_COUNT + 1) := CONCAT(SPLIT_ARR(LSEP_COUNT + 1),<br />                                            CHR(ASCII(STR_TMP)));<br />      END IF;<br />          IF LENGTH(STR_TMP) = 1 AND LENGTH(SPLIT_ARR(LSEP_COUNT + 1)) &gt; 0 THEN<br />        LSEP_COUNT := LSEP_COUNT + 1;<br />      END IF;<br />    END LOOP;<br />      RETURN LSEP_COUNT;<br />  END;<br /><br /><br /><br /><br /><br /><br /><br /><br />
</body>
</html>
